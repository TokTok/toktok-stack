load("@rules_cc//cc:defs.bzl", "cc_library")

licenses(["notice"])

exports_files(
    srcs = [
        "vpx_version.h",
    ],
    visibility = ["@libvpx//:__pkg__"],
)

alias(
    name = "libs.mk",
    actual = select({
        "@toktok//tools/config:linux-arm64": "linux-arm64/libs-arm64-linux-gcc.mk",
        "@toktok//tools/config:linux-x86_64": "linux-x86_64/libs-x86_64-linux-gcc.mk",
    }),
    visibility = ["@libvpx//:__pkg__"],
)

genrule(
    name = "platform_asm_header",
    srcs = select({
        "@toktok//tools/config:linux-arm64": [],
        "@toktok//tools/config:linux-x86_64": ["linux-x86_64/vpx_config.asm"],
    }),
    outs = ["vpx_config.asm"],
    cmd = "cp $< $@",
    visibility = ["@libvpx//:__pkg__"],
)

genrule(
    name = "platform_header",
    srcs = select({
        "@toktok//tools/config:linux-arm64": ["linux-arm64/vpx_config.h"],
        "@toktok//tools/config:linux-x86_64": ["linux-x86_64/vpx_config.h"],
    }),
    outs = ["vpx_config.h"],
    cmd = "cp $< $@",
)

cc_library(
    name = "vpx_config",
    hdrs = [":platform_header"],
    includes = ["."],
    visibility = ["@libvpx//:__pkg__"],
)

cc_library(
    name = "vpx_version",
    hdrs = ["vpx_version.h"],
    includes = ["."],
    visibility = ["@libvpx//:__pkg__"],
)
