#!/bin/sh

set -eux

ATTEMPTS="$1"
shift

for i in "$(seq 1 "$ATTEMPTS")"; do
  echo "=== Attempt $i ==="
  if "$@"; then
    exit 0
  fi
done

echo "Failed after $ATTEMPTS attempts: $@"
exit 1
